openapi: 3.0.0
info:
  title: MSA Support - Hiberus Test - Payment Order V1
  description: |
    <sup>(ES)</sup> Microservicio de soporte que permite recuperar y gestionar órdenes de pago. <br><br>
    <sup>(EN)</sup> Microservice support that allows retrieving and managing payment orders. <br><br>
    <br>
    <b>• Business Area:</b> `Operation and Execution`
    <br>
    <b>• Business Domain:</b> `Cross Product Operations`
    <br>
    <b>• Service Domain:</b> `Payment Order`
  contact:
    name: Hiberus Test - Jorge Barreto
    email: jorg3lui5@hotmail.com
  version: 1.0.0

servers:
  - url: https://hib-msa-sp-payment-order-dev.com
    description: Development environment.
  - url: https://hib-msa-sp-payment-order-test.com
    description: Testing environment.
  - url: https://hib-msa-sp-payment-order.com
    description: Production environment.

tags:
  - name: Payment Order
    description: Payment Order Controller

paths:
  /payment-orders/initiate:
    post:
      tags:
        - Payment Order
      summary: |
        ⁽ᴱˢ⁾ Iniciar orden de pago.
        ⁽ᴱᴺ⁾ Initiate Payment Order.
      operationId: PostInitiatePaymentOrder
      description: |
        ### Details:
        <sup>(ES)</sup> Iniciar un procedimiento de orden de pago.<br>
        <sup>(EN)</sup> Initiate a payment order procedure.<br><br>
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostInitiatePaymentOrderRequest'
            examples:
              PostInitiatePaymentOrderRequestExample:
                $ref: "#/components/examples/PostInitiatePaymentOrderRequestExample"
      responses:
        "201":
          description: |
            <b>`Created`</b><br><br>
            <sup><i>(ES)</i></sup> Solicitud exitosa.
            <br><br>
            <sup><i>(EN)</i></sup> Successful request.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PostInitiatePaymentOrderResponse"
              examples:
                PostInitiatePaymentOrderResponseExample:
                  $ref: "#/components/examples/PostInitiatePaymentOrderResponseExample"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "409":
          $ref: '#/components/responses/Conflict'
        "429":
          $ref: '#/components/responses/TooManyRequests'
        "500":
          $ref: '#/components/responses/InternalServerError'
        "504":
          $ref: '#/components/responses/GatewayTimeout'

  /payment-orders/{paymentOrderId}:
    get:
      tags:
        - Payment Order
      summary: |
        ⁽ᴱˢ⁾ Recupera la orden de pago.
        ⁽ᴱᴺ⁾ Retrieve payment order.
      operationId: GetPaymentOrderById
      description: |
        ### Details:
        <sup>(ES)</sup> Recupera la orden de pago.<br>
        <sup>(EN)</sup> Retrieve payment order.<br><br>
        
        | Expected Result  | Path Parameter | Query Parameter                 |
        | ---------------- | ------------   | -----------------------------------|
        | Retrieve user status | paymentOrderId | - |
      parameters:
        - $ref: '#/components/parameters/paymentOrderId'
      responses:
        "200":
          description: |
            <b>`OK`</b><br><br>
            <sup><i>(ES)</i></sup> Solicitud exitosa.
            <br><br>
            <sup><i>(EN)</i></sup> Successful request.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetPaymentOrderByIdResponse"
              examples:
                GetPaymentOrderByIdResponseExample:
                  $ref: "#/components/examples/GetPaymentOrderByIdResponseExample"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "409":
          $ref: '#/components/responses/Conflict'
        "429":
          $ref: '#/components/responses/TooManyRequests'
        "500":
          $ref: '#/components/responses/InternalServerError'
        "504":
          $ref: '#/components/responses/GatewayTimeout'
  /payment-orders/{paymentOrderId}/status:
    get:
      tags:
        - Payment Order
      summary: |
        ⁽ᴱˢ⁾ Recupera el estado de la orden.
        ⁽ᴱᴺ⁾ Retrieve order status.
      operationId: GetStatusPaymentOrderById
      description: |
        ### Details:
        <sup>(ES)</sup> Recupera el estado de la orden de pago.<br>
        <sup>(EN)</sup> Retrieve the payment order status.<br><br>
        
        | Expected Result  | Path Parameter | Query Parameter                 |
        | ---------------- | ------------   | -----------------------------------|
        | Retrieve user status | paymentOrderId | - |
      parameters:
        - $ref: '#/components/parameters/paymentOrderId'
      responses:
        "200":
          description: |
            <b>`OK`</b><br><br>
            <sup><i>(ES)</i></sup> Solicitud exitosa.
            <br><br>
            <sup><i>(EN)</i></sup> Successful request.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetStatusPaymentOrderByIdResponse"
              examples:
                GetStatusPaymentOrderByIdResponseExample:
                  $ref: "#/components/examples/GetStatusPaymentOrderByIdResponseExample"
        "400":
          $ref: '#/components/responses/BadRequest'
        "401":
          $ref: '#/components/responses/Unauthorized'
        "403":
          $ref: '#/components/responses/Forbidden'
        "404":
          $ref: '#/components/responses/NotFound'
        "409":
          $ref: '#/components/responses/Conflict'
        "429":
          $ref: '#/components/responses/TooManyRequests'
        "500":
          $ref: '#/components/responses/InternalServerError'
        "504":
          $ref: '#/components/responses/GatewayTimeout'
components:
  parameters:
    paymentOrderId:
      name: paymentOrderId
      in: query
      required: false
      description: |
        <sup><i>(ES)</i></sup> ID de la orden de pago. <br>
        <sup><i>(EN)</i></sup> Payment order ID. <br>
      schema:
        $ref: "#/components/schemas/PaymentOrderId"
  schemas:
    PostInitiatePaymentOrderRequest:
      type: object
      description: |
        <sup><i>(ES)</i></sup> Solicitud para iniciar una Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Request to initiate a Payment Order.
      required:
        - externalReference
        - debtorAccount
        - creditorAccount
        - instructedAmount
        - requestedExecutionDate
      properties:
        externalReference:
          $ref: '#/components/schemas/ExternalReference'
        debtorAccount:
          $ref: '#/components/schemas/Account'
        creditorAccount:
          $ref: '#/components/schemas/Account'
        instructedAmount:
          $ref: '#/components/schemas/InstructedAmount'
        remittanceInformation:
          $ref: '#/components/schemas/RemittanceInformation'
        requestedExecutionDate:
          $ref: '#/components/schemas/RequestedExecutionDate'
    PostInitiatePaymentOrderResponse:
      type: object
      description: |
        <sup><i>(ES)</i></sup> Datos de respuesta de una Orden de Pago inicializada.
        <br><br>
        <sup><i>(EN)</i></sup> Response data for an initialized Payment Order.
      properties:
        paymentOrderId:
          $ref: '#/components/schemas/PaymentOrderId'
        status:
          $ref: '#/components/schemas/PaymentOrderStatus'
    GetStatusPaymentOrderByIdResponse:
      type: object
      description: |
        <sup><i>(ES)</i></sup> Estado actual de la Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Current status of payment order.
      properties:
        paymentOrderId:
          $ref: '#/components/schemas/PaymentOrderId'
        status:
          $ref: '#/components/schemas/PaymentOrderStatus'
        lastUpdate:
          $ref: '#/components/schemas/PaymentOrderLastUpdate'
    GetPaymentOrderByIdResponse:
      description: |
        <sup><i>(ES)</i></sup> Orden de Pago recuperada.
        <br><br>
        <sup><i>(EN)</i></sup> Payment order retrieved.
      allOf:
        - $ref: '#/components/schemas/PaymentOrder'

    PaymentOrder:
      type: object
      description: |
        <sup><i>(ES)</i></sup> Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> payment order.
      properties:
        paymentOrderId:
          $ref: '#/components/schemas/PaymentOrderId'
        externalReference:
          $ref: '#/components/schemas/ExternalReference'
        debtorAccount:
          $ref: '#/components/schemas/Account'
        creditorAccount:
          $ref: '#/components/schemas/Account'
        instructedAmount:
          $ref: '#/components/schemas/InstructedAmount'
        remittanceInformation:
          $ref: '#/components/schemas/RemittanceInformation'
        requestedExecutionDate:
          $ref: '#/components/schemas/RequestedExecutionDate'
        status:
          $ref: '#/components/schemas/PaymentOrderStatus'

    ExternalReference:
      type: string
      description: |
        <sup><i>(ES)</i></sup> Identificador externo de la orden de pago.
        <br><br>
        <sup><i>(EN)</i></sup> External payment order identifier provided by the initiating channel.
      minLength: 1
      maxLength: 35
      pattern: '^[A-Za-z0-9\-]+$'
    Account:
      type: object
      description: |
        <sup><i>(ES)</i></sup> Identificación de una cuenta bancaria.
        <br><br>
        <sup><i>(EN)</i></sup> Bank account identification.
      required:
        - iban
      properties:
        iban:
          type: string
          description: |
            <sup><i>(ES)</i></sup> IBAN de la cuenta bancaria.
            <br><br>
            <sup><i>(EN)</i></sup> Bank account IBAN.
          minLength: 1
          maxLength: 34
          pattern: '^[A-Za-z0-9\-]+$'
    InstructedAmount:
      type: object
      description: |
        <sup><i>(ES)</i></sup> Monto instruido para la orden de pago.
        <br><br>
        <sup><i>(EN)</i></sup> Amount instructed for the payment order.
      required:
        - amount
        - currency
      properties:
        amount:
          type: number
          format: decimal
          description: |
            <sup><i>(ES)</i></sup> Valor monetario de la orden de pago.
            <br><br>
            <sup><i>(EN)</i></sup> Monetary value of the payment order.
          minimum: 0.01
          maximum: 999999999.99
        currency:
          type: string
          description: |
            <sup><i>(ES)</i></sup> Código de moneda conforme a ISO 4217.
            <br><br>
            <sup><i>(EN)</i></sup> Currency code according to ISO 4217.
          minLength: 3
          maxLength: 3
          pattern: '^[A-Z]{3}$'
    RemittanceInformation:
      type: string
      description: |
        <sup><i>(ES)</i></sup> Información adicional para conciliación del pago.
        <br><br>
        <sup><i>(EN)</i></sup> Additional remittance information for payment reconciliation.
      minLength: 1
      maxLength: 140
    RequestedExecutionDate:
      type: string
      format: date
      description: |
        <sup><i>(ES)</i></sup> Fecha solicitada para la ejecución de la orden de pago.
        <br><br>
        <sup><i>(EN)</i></sup> Requested execution date of the payment order.
    PaymentOrderId:
      type: string
      description: |
        <sup><i>(ES)</i></sup> Identificador único interno de la Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Internal unique identifier of the Payment Order.
      minLength: 1
      maxLength: 35
      pattern: '^[A-Za-z0-9\-]+$'
    PaymentOrderStatus:
      type: string
      description: |
        <sup><i>(ES)</i></sup> Estado de ciclo de vida de la Orden de Pago conforme al modelo BIAN.
        <br><br>
        <sup><i>(EN)</i></sup> Lifecycle status of the Payment Order according to the BIAN model.
      minLength: 1
      maxLength: 30
      enum:
        - INITIATED
        - VALIDATED
        - PENDINGEXECUTION
        - EXECUTED
        - REJECTED
        - CANCELLED
    PaymentOrderLastUpdate:
      type: string
      format: date-time
      description: |
        <sup><i>(ES)</i></sup> Fecha y hora de la última actualización del estado
        de la Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Date and time when the Payment Order status was last updated.

  examples:
    PostInitiatePaymentOrderRequestExample:
      summary: Initiate Payment Order request
      description: |
        <sup><i>(ES)</i></sup> Ejemplo de solicitud para iniciar una Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Example request to initiate a Payment Order.
      value:
        externalReference: EXT-123
        debtorAccount:
          iban: EC12DEBTOR
        creditorAccount:
          iban: EC98CREDITOR
        instructedAmount:
          amount: 150.75
          currency: USD
        remittanceInformation: Factura 001-123
        requestedExecutionDate: 2025-10-31
    PostInitiatePaymentOrderResponseExample:
      summary: Payment Order successfully initiated
      description: |
        <sup><i>(ES)</i></sup> Ejemplo de respuesta al iniciar una Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Example response for a successfully initiated Payment Order.
      value:
        paymentOrderId: PO-0001
        status: INITIATED
    GetPaymentOrderByIdResponseExample:
      summary: Payment Order retrieved by identifier
      description: |
        <sup><i>(ES)</i></sup> Ejemplo de recuperación completa de una Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Example of a Payment Order retrieved by its identifier.
      value:
        paymentOrderId: PO-0001
        externalReference: EXT-123
        debtorAccount:
          iban: EC12DEBTOR
        creditorAccount:
          iban: EC98CREDITOR
        instructedAmount:
          amount: 150.75
          currency: USD
        remittanceInformation: Factura 001-123
        requestedExecutionDate: 2025-10-31
        status: EXECUTED
    GetStatusPaymentOrderByIdResponseExample:
      summary: Payment Order status retrieved
      description: |
        <sup><i>(ES)</i></sup> Ejemplo de consulta del estado actual de una Orden de Pago.
        <br><br>
        <sup><i>(EN)</i></sup> Example of retrieving the current status of a Payment Order.
      value:
        paymentOrderId: PO-0001
        status: EXECUTED
        lastUpdate: 2025-10-30T16:25:30Z